<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

  <changeSet id="localizedvalues" author="antti.leppa">
    <createTable tableName="localizedentry">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
    </createTable>
    
    <createTable tableName="localizedvalue">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="entry_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_LOCALIZED_VALUE_ENTRY_ID" referencedColumnNames="id" referencedTableName="localizedentry"/>
      </column>
      <column name="locale" type="varchar(191)">
        <constraints nullable="false"/>
      </column>
      <column name="value" type="longtext">
        <constraints nullable="false"/>
      </column>    
    </createTable>
  </changeSet>
  
  <changeSet id="seed" author="antti.leppa">
    <createTable tableName="seed">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="name_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_SEED_LOCALIZED_ENTRY_ID" referencedColumnNames="id" referencedTableName="localizedentry"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="team-19.12.2018-19:00" author="ville.koivukangas">
    <createTable tableName="team">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="name_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_TEAM_LOCALIZED_ENTRY_ID" referencedColumnNames="id" referencedTableName="localizedentry"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="wastagereason" author="ville.koivukangas">
    <createTable tableName="wastagereason">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="reason_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_WASTAGEREASON_LOCALIZED_ENTRY_ID" referencedColumnNames="id" referencedTableName="localizedentry"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="seedbatch" author="ville.koivukangas">
    <createTable tableName="seedbatch">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="code" type="varchar(191)">
        <constraints nullable="false"/>
      </column>
      <column name="seed_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_SEEDBATCH_SEED_ID" referencedColumnNames="id" referencedTableName="seed"/>
      </column>
      <column name="time" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="packagesize" author="ville.koivukangas">
    <createTable tableName="packagesize">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="name" type="varchar(191)">
        <constraints nullable="false"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="product" author="ville.koivukangas">
    <createTable tableName="product">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="name_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_PRODUCT_LOCALIZED_ENTRY_ID" referencedColumnNames="id" referencedTableName="localizedentry"/>
      </column>
      <column name="defaultpackagesize_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_PRODUCT_PACKAGESIZE_ID" referencedColumnNames="id" referencedTableName="packagesize"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="batch" author="ville.koivukangas">
    <createTable tableName="batch">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="product_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_BATCH_PRODUCT_ID" referencedColumnNames="id" referencedTableName="product"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="productionline" author="ville.koivukangas">
    <createTable tableName="productionline">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="linenumber" type="INT">
        <constraints nullable="false"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="performedcultivationaction" author="ville.koivukangas">
    <createTable tableName="performedcultivationaction">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="name_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_PERFORMEDCULTIVATIONACTION_LOCALIZED_ENTRY_ID" referencedColumnNames="id" referencedTableName="localizedentry"/>
      </column>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
      
  <changeSet id="event" author="antti.leppa">
    <createTable tableName="event">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>
      <column name="batch_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_EVENT_BATCH_ID" referencedColumnNames="id" referencedTableName="batch"/>
      </column>
      <column name="starttime" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="endtime" type="timestamp"/>
      <column name="creatorid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="lastmodifierid" type="binary(16)">
        <constraints nullable="false"/>
      </column>
      <column name="createdat" type="timestamp">
        <constraints nullable="false"/>
      </column>
      <column name="modifiedat" type="timestamp">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
      
  <changeSet id="sowingevent" author="antti.leppa">
    <createTable tableName="sowingevent">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true" foreignKeyName="FK_SOWINGEVENT_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="seedbatch_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_SOWINGEVENT_SEEDBATCH_ID" referencedColumnNames="id" referencedTableName="seedbatch"/>
      </column>
      <column name="productionline_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_SOWINGEVENT_PRODUCTIONLINE_ID" referencedColumnNames="id" referencedTableName="productionline"/>
      </column>
      <column name="gutternumber" type="integer"/>
      <column name="celltype" type="varchar(191)">
        <constraints nullable="false"/>
      </column>
      <column name="amount" type="double">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="tablespreadevent" author="antti.leppa">
    <createTable tableName="tablespreadevent">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true" foreignKeyName="FK_TABLESPREADEVENT_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="location" type="varchar(191)">
        <constraints nullable="false"/>
      </column>
      <column name="tablecount" type="int(32)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  
  <changeSet id="cultivationobservationevent" author="antti.leppa">
    <createTable tableName="cultivationobservationevent">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true" foreignKeyName="FK_CULTIVATIONOBSERVATIONEVENT_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="pests" type="varchar(191)"/>
      <column name="weight" type="double"/>
      <column name="luminance" type="double"/>
    </createTable>
  </changeSet>
  
  <changeSet id="cultivationobservationeventaction" author="antti.leppa">
    <createTable tableName="cultivationobservationeventaction">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true"/>
      </column>      
      <column name="event_id" type="binary(16)">
        <constraints nullable="false" primaryKey="true" foreignKeyName="FK_CULTIVATIONOBSERVATIONEVENTACTION_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="action_id" type="binary(16)">
        <constraints nullable="false" primaryKey="true" foreignKeyName="FK_CULTIVATIONOBSERVATIONEVENTACTION_ACTION_ID" referencedColumnNames="id" referencedTableName="performedcultivationaction"/>
      </column>
    </createTable>
  </changeSet>
      
  <changeSet id="harvestevent" author="antti.leppa">
    <createTable tableName="harvestevent">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true" foreignKeyName="FK_HARVESTEVENT_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="team_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_HARVESTEVENT_TEAM_ID" referencedColumnNames="id" referencedTableName="team"/>
      </column>
      <column name="productionline_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_HARVESTEVENT_PRODUCTIONLINE_ID" referencedColumnNames="id" referencedTableName="productionline"/>
      </column>
      <column name="harvestType" type="varchar(191)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
      
  <changeSet id="plantingevent" author="antti.leppa">
    <createTable tableName="plantingevent">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true" foreignKeyName="FK_PLANTINGEVENT_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="productionline_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_PLANTINGEVENT_PRODUCTIONLINE_ID" referencedColumnNames="id" referencedTableName="productionline"/>
      </column>
      <column name="gutternumber" type="int(32)">
        <constraints nullable="false"/>
      </column>
      <column name="guttercount" type="int(32)">
        <constraints nullable="false"/>
      </column>
      <column name="traycount" type="int(32)">
        <constraints nullable="false"/>
      </column>
      <column name="workerCount" type="int(32)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="wastageevent" author="Heikki Kurhinen">
    <createTable tableName="wastageevent">
      <column name="id" type="binary(16)">
        <constraints unique="true" nullable="false" primaryKey="true" foreignKeyName="FK_WASTAGEEVENT_EVENT_ID" referencedColumnNames="id" referencedTableName="event"/>
      </column>
      <column name="wastegereason_id" type="binary(16)">
        <constraints nullable="false" foreignKeyName="FK_WASTAGEEVENT_WASTAGEREASON_ID" referencedColumnNames="id" referencedTableName="wastagereason"/>
      </column>
      <column name="amount" type="int(32)">
        <constraints nullable="false"/>
      </column>
      <column name="description" type="longtext"></column>
    </createTable>
  </changeSet>

</databaseChangeLog>